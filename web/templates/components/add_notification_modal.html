{{define "add_notification_modal"}}
<!-- Add/Edit Notification Modal -->
<dialog id="notificationModal" class="modal">
    <div class="modal-box w-11/12 max-w-3xl">
        <!-- Header -->
        <div class="flex justify-between items-center mb-6">
            <h3 class="font-bold text-2xl" id="notificationModalTitle">Add Notification</h3>
            <button type="button" class="btn btn-sm btn-circle btn-ghost" onclick="closeNotificationModal()">✕</button>
        </div>

        <form id="notificationForm" class="space-y-4">
            <input type="hidden" id="notification_id" name="notification_id">
            <input type="hidden" id="notification_provider_type" name="notification_provider_type" value="discord">

            <!-- Name -->
            <div class="form-control">
                <label class="label">
                    <span class="label-text font-semibold">Notification Name*</span>
                </label>
                <input type="text" id="notification_name" name="notification_name" class="input input-bordered" placeholder="My Birthday Notifications" required>
                <label class="label">
                    <span class="label-text-alt">A friendly name to identify this notification</span>
                </label>
            </div>

            <!-- Webhook URL -->
            <div class="form-control" id="notification_webhook_url">
                <label class="label">
                    <span class="label-text font-semibold">Discord Webhook URL*</span>
                </label>
                <input type="url" name="notification_webhook_url" class="input input-bordered font-mono text-sm" placeholder="https://discord.com/api/webhooks/..." required>
                <label class="label">
                    <span class="label-text-alt">Get this from Discord Server Settings → Integrations → Webhooks</span>
                </label>
            </div>

            <!-- Target Address -->
            <div class="form-control" id="notification_target_address">
                <label class="label">
                    <span class="label-text font-semibold">Recipient Email Address*</span>
                </label>
                <input type="email" name="notification_target_address" class="input input-bordered font-mono text-sm" placeholder="you@example.com" required>
            </div>

            <!-- Timing Settings -->
            <div class="card bg-base-200 shadow-md">
                <div class="card-body">
                    <h3 class="font-bold mb-4">Notification Timing</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text">Notify on events ocurring in the next...</span>
                            </label>
                            <select id="notification_days_look_ahead" name="notification_days_look_ahead" class="select select-bordered">
                                <option value="0" selected>Today</option>
                                <option value="1">1 days</option>
                                <option value="2">2 days</option>
                                <option value="3">3 days</option>
                                <option value="7">1 week</option>
                            </select>
                        </div>

                        <div class="form-control">
                            <label class="label">
                                <span class="label-text">Time of Day (24-hour)</span>
                            </label>
                            <input type="time" id="notification_notification_time" name="notification_notification_time" class="input input-bordered" value="09:00" required>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Options -->
            <div class="card bg-base-200 shadow-md">
                <div class="card-body">
                    <h3 class="font-bold mb-4">Options</h3>
                    <div class="space-y-3">
                        <div class="form-control">
                            <label class="label cursor-pointer justify-start gap-3">
                                <input type="checkbox" id="notification_enabled" name="notification_enabled" class="toggle toggle-primary" checked>
                                <span class="label-text font-semibold">Enable this notification</span>
                            </label>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="form-control">
                                <label class="label cursor-pointer justify-start gap-3">
                                    <input type="checkbox" id="notification_include_birthdays" name="notification_include_birthdays" class="checkbox checkbox-primary">
                                    <span class="label-text">Include Birthday Events</span>
                                </label>
                            </div>

                            <div class="form-control">
                                <label class="label cursor-pointer justify-start gap-3">
                                    <input type="checkbox" id="notification_include_anniversaries" name="notification_include_anniversaries" class="checkbox checkbox-primary">
                                    <span class="label-text">Include Anniversary Events</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-control">
                            <label class="label cursor-pointer justify-start gap-3">
                                <input type="checkbox" id="notification_include_event_dates" name="notification_include_event_dates" class="checkbox checkbox-primary">
                                <span class="label-text">Include Other Events</span>
                            </label>
                        </div>

                        <!-- Other Event Regex -->
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Other Events Regex Filter</span>
                            </label>
                            <input type="text" id="notification_other_event_regex" name="notification_other_event_regex" class="input input-bordered font-mono text-sm" placeholder="(first tooth|rode (bike|scooter))">
                            <label class="label">
                                <span class="label-text-alt">Omit to include all events regardless of their Name. Case insensitive.</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="modal-action">
                <button type="button" class="btn btn-ghost" onclick="closeNotificationModal()">Cancel</button>
                <button type="submit" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span id="notificationSubmitText">Save Notification</span>
                </button>
            </div>
        </form>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>
{{end}}
